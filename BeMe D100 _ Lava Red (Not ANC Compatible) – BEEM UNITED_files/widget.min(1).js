"use strict";function openShowTime(){window.proonto.openChat()}var proontoScriptIsLoaded;if(proontoScriptIsLoaded||null!==document.getElementById("proonto-widget"))throw new Error("Proonto JS tried to load twice - we blocked it, please make sure to remove the duplicated JS tag");proontoScriptIsLoaded=!0,function(WINDOW,undefined){try{var DisplayForm={none:"NONE",onlineEntrance:"ONLINE_ENTRANCE",onlineChat:"ONLINE_CHAT",contactDetails:"CONTACT_DETAILS",chatInvitation:"CHAT_INVITATION",chatLeadForm:"CHAT_LEAD_FORM"},DEVICE_TYPES={DESKTOP:"desktop",TABLET:"tablet",SMARTPHONE:"smartphone"},reportError=function(exception){var host;if(window.ENV&&window.ENV.apiPrefix)host=window.ENV.apiPrefix;else{if("undefined"==typeof WIDGET_HOST)return;host=WIDGET_HOST+"/rest/"}var queryParam=encodeURIComponent("exception")+"="+encodeURIComponent(exception?exception.message+"\n"+exception.stack:""),myImage=new Image(1,2);throw myImage.src=host+"system/ui-errors?"+queryParam,exception},MessageFactory=function(ORIGIN_REGEX,TARGET_WINDOW){var self=this,REPLY_REGEX=/^REPLY_(\d+)$/;this.handlers={},this.messages={},this.send=function(type,content,callback){var randomNum=Math.floor(1e3*Math.random()+1),message={type:type,content:content,id:Date.now()+randomNum,isProonto:!0};self.messages[message.id]={data:message,callback:callback},"object"==typeof TARGET_WINDOW&&TARGET_WINDOW.postMessage(message,"*")};var handleMessage=function(event){var receivedMessage=event.data;if(REPLY_REGEX.test(receivedMessage)){var matches=REPLY_REGEX.exec(receivedMessage);if(!matches)return;var messageId=matches[1],sentMessage=self.messages[messageId];if(!sentMessage)return;if(sentMessage.callback)try{sentMessage.callback()}catch(e){reportError(e)}return void delete self.messages[messageId]}if(receivedMessage.isProonto){var handlers=self.handlers[receivedMessage.type];if(handlers)for(var i=0;i<handlers.length;i++)try{handlers[i](receivedMessage.content)}catch(e){reportError(e)}event.source.postMessage("REPLY_"+receivedMessage.id,event.origin)}};this.on=function(type,fn){self.handlers[type]||(self.handlers[type]=[]);for(var handlers=self.handlers[type],i=0,len=handlers.length;len>i;i++)if(handlers[i]===fn)return!1;return handlers.push(fn),!0},this.off=function(type,fn){if(self.handlers[type]){for(var handlers=self.handlers[type],i=0,len=handlers.length;len>i;i++)if(handlers[i]===fn)return handlers.splice(i,1),!0;return!1}},window.addEventListener?window.addEventListener("message",handleMessage,!1):window.attachEvent&&window.attachEvent("onmessage",handleMessage)};MessageFactory.prototype.toWidget={widgetLoad:"WIDGET_LOAD",customButton:"CUSTOM_BUTTON",messageClick:"MESSAGE_CLICK",newState:"NEW_STATE",blockClient:"BLOCK_CLIENT",contactDetailsEntered:"CONTACT_DETAILS_ENTERED",resize:"DO_RESIZE",setWidgetFocusState:"SET_WIDGET_FOCUS_STATE",calcTitleAnimation:"CALC_TITLE_ANIMATION",onChatMessage:"ON_CHAT_MESSAGE",expandWidget:"SCROLL_TO_BOTTOM",collapseWidget:"SCROLL_BACK",findWidget:"FIND_WIDGET",sendFocus:"SEND_FOCUS",sendBlur:"SEND_BLUR",onClientAction:{name:"ON_CLIENT_ACTION",events:{ACCEPT_INVITATION:"Visitor accepted invitation",UPDATE_NAME:"Visitor updated his name",CONTACT_DETAILS_ENTERED:"Visitor filled contact details",CLICK_CALL:"Visitor started a phone call",REQUEST_VIDEO:"Visitor requested a video chat",REQUEST_AUDIO:"Visitor requested an audio chat",CLICK_CHAT:"Live chat clicked"}},onClientFeedback:"ON_CLIENT_FEEDBACK",onAgentApproach:"ON_AGENT_APPROACH"},MessageFactory.prototype.toHost={openChat:"OPEN_CHAT",openPhonePanel:"OPEN_PHONE_PANEL",openAudioChat:"OPEN_AUDIO_CHAT",setClientDetails:"SET_CLIENT_DETAILS",setCustomClientId:"CUSTOM_CLIENT_ID",sendEvent:"SEND_CLIENT_EVENT",sendIdleMode:"SET_IDLE_MODE",playSound:"PLAY_SOUND",hideWidgetOnPage:"HIDE_WIDGET_ON_PAGE",parentParams:"PARENT_PARAMS"};var WIDGET_WINDOW,WIDGET_CONTAINER,MESSAGE,CLIENT_ID,UNIQUE_ID,COMPANY_ID,IS_IN_CONTROL_GROUP,IS_AGENT_ONLINE,CLIENT_NAME,AGENT,STATES_STYLES,pollMobilePosition,WIDGET_HOST="https://chat.proonto.com/chat",getHostedDomain=function(){var domain,firstDot=window.location.hostname.indexOf("."),lastDot=window.location.hostname.lastIndexOf("."),isSubdomain=lastDot>firstDot,isLocalDomain=window.location.hostname.indexOf(".co.");return domain=isSubdomain&&-1===isLocalDomain?window.location.hostname.substring(-1===firstDot?0:firstDot+1):window.location.hostname,"."+domain},setProontoCookie=function(cname,cvalue,exhours){var d=new Date;d.setTime(d.getTime()+60*exhours*60*1e3);var expires="expires="+d.toUTCString();document.cookie=cname+"="+encodeURIComponent(cvalue)+"; "+expires+"; domain="+getHostedDomain()},getProontoCookie=function(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(name)){var cval=c.substring(name.length,c.length);return decodeURIComponent(cval)}}return""},setProontoData=function(cname,cvalue,exhours){setProontoCookie(cname,cvalue,exhours)},getProontoData=function(cname){var val=getProontoCookie(cname);return val},ORIGIN_REGEX=(function(){function Promise(){this._callbacks=[]}function join(promises){function notifier(i){return function(){numdone+=1,results[i]=Array.prototype.slice.call(arguments),numdone===total&&p.done(results)}}var p=new Promise,results=[];if(!promises||!promises.length)return p.done(results),p;for(var numdone=0,total=promises.length,i=0;total>i;i++)promises[i].then(notifier(i));return p}function chain(funcs,args){var p=new Promise;return 0===funcs.length?p.done.apply(p,args):funcs[0].apply(null,args).then(function(){funcs.splice(0,1),chain(funcs,arguments).then(function(){p.done.apply(p,arguments)})}),p}function _encode(data){var result="";if("string"==typeof data)result=data;else{var e=encodeURIComponent;for(var k in data)data.hasOwnProperty(k)&&(result+="&"+e(k)+"="+e(data[k]))}return result}function new_xhr(){var xhr;if(WINDOW.XMLHttpRequest)xhr=new XMLHttpRequest;else if(WINDOW.ActiveXObject)try{xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){xhr=new ActiveXObject("Microsoft.XMLHTTP")}return xhr}function ajax(method,url,data,headers){function onTimeout(){xhr.abort(),p.done(promise.ETIMEOUT,"",xhr)}var xhr,payload,p=new Promise;data=data||{},headers=headers||{};try{xhr=new_xhr()}catch(e){return p.done(promise.ENOXHR,""),p}payload=_encode(data),"GET"===method&&payload&&(url+="?"+payload,payload=null),xhr.open(method,url),xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var h in headers)headers.hasOwnProperty(h)&&xhr.setRequestHeader(h,headers[h]);var timeout=promise.ajaxTimeout;if(timeout)var tid=setTimeout(onTimeout,timeout);return xhr.onreadystatechange=function(){if(timeout&&clearTimeout(tid),4===xhr.readyState){var err=!xhr.status||(xhr.status<200||xhr.status>=300)&&304!==xhr.status;p.done(err,xhr.responseText,xhr)}},xhr.send(payload),p}function _ajaxer(method){return function(url,data,headers){return ajax(method,url,data,headers)}}Promise.prototype.then=function(func,context){var p;return this._isdone?p=func.apply(context,this.result):(p=new Promise,this._callbacks.push(function(){var res=func.apply(context,arguments);res&&"function"==typeof res.then&&res.then(p.done,p)})),p},Promise.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var i=0;i<this._callbacks.length;i++)this._callbacks[i].apply(null,arguments);this._callbacks=[]};var promise={Promise:Promise,join:join,chain:chain,ajax:ajax,get:_ajaxer("GET"),post:_ajaxer("POST"),put:_ajaxer("PUT"),del:_ajaxer("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};return Promise.join=join,Promise.chain=chain,Promise.ajax=ajax,Promise.get=promise.get,Promise.post=promise.post,Promise.put=promise.put,Promise.del=promise.del,Promise}(),/.*/g),WIDGET=function(WINDOW){var publicHandlers={},on=function(handlersCol,type,callback,context){handlersCol[type]||(handlersCol[type]=[]);for(var handlers=handlersCol[type],i=0,len=handlers.length;len>i;i++)if(handlers[i]===callback)return!1;return handlers.push(callback),!0},off=function(handlersCol,type,callback){if(!handlersCol[type])return!1;for(var handlers=handlersCol[type],i=0,len=handlers.length;len>i;i++)if(handlers[i]===callback)return handlers.splice(i,1),!0;return!1};WINDOW.proonto={layout:{},Events:{CONTACT_DETAILS_ENTERED:"CONTACT_DETAILS_ENTERED",onClientDetailsEntered:"CONTACT_DETAILS_ENTERED",onUpdateCustomId:"CUSTOM_CLIENT_ID",onChatMessage:"ON_CHAT_MESSAGE",onClientAction:"ON_CLIENT_ACTION",onShow:"ON_SHOW",onHide:"ON_HIDE",onClientFeedback:"ON_CLIENT_FEEDBACK"},on:function(type,callback){return on(publicHandlers,type,callback)},off:function(type,callback){return off(publicHandlers,type,callback)},openChat:function(){MESSAGE.send(MESSAGE.toHost.openChat,"",function(){})},openAudioChat:function(){MESSAGE.send(MESSAGE.toHost.openAudioChat,"",function(){})},openPhonePanel:function(){MESSAGE.send(MESSAGE.toHost.openPhonePanel,"",function(){})},getClientId:function(){return CLIENT_ID},getUniqueId:function(){return UNIQUE_ID},getAgent:function(){return AGENT},isAgentOnline:function(){return IS_AGENT_ONLINE},getCompanyId:function(){return COMPANY_ID},isInControlGroup:function(){return IS_IN_CONTROL_GROUP},setClientDetails:function(name,email,phone,msg,sendNotification){var clientDetails={name:name,email:email,phone:phone,msg:msg,sendNotification:sendNotification};MESSAGE.send(MESSAGE.toHost.setClientDetails,clientDetails,function(){})},setCustomClientId:function(customId){MESSAGE.send(MESSAGE.toHost.setCustomClientId,customId,function(){})},sendEvent:function(eventCategory,eventType){var eventData={eventCategory:eventCategory,eventType:eventType};MESSAGE.send(MESSAGE.toHost.sendEvent,eventData,function(){})},hideWidgetOnPage:function(showOnEngagments){MESSAGE.send(MESSAGE.toHost.hideWidgetOnPage,showOnEngagments,function(){})}};var api={isWidgetCurrentlyShown:!1,contactDetailsEnteredApi:function(clientDetails){var type=WINDOW.proonto.Events.CONTACT_DETAILS_ENTERED;if(publicHandlers[type])for(var handlers=publicHandlers[type],i=0,len=handlers.length;len>i;i++)handlers[i](clientDetails.name,clientDetails.email,clientDetails.phone,clientDetails.msg)},clientActionApi:function(actionEvent){var type=WINDOW.proonto.Events.onClientAction;if(publicHandlers[type])for(var handlers=publicHandlers[type],i=0,len=handlers.length;len>i;i++)handlers[i](actionEvent.clientId,actionEvent.description)},chatMessageApi:function(params){var type=WINDOW.proonto.Events.onChatMessage;if(publicHandlers[type])for(var handlers=publicHandlers[type],i=0,len=handlers.length;len>i;i++)handlers[i].apply(handlers[i],params)},onClientFeedback:function(params){var type=WINDOW.proonto.Events.onClientFeedback;if(publicHandlers[type])for(var handlers=publicHandlers[type],i=0,len=handlers.length;len>i;i++)handlers[i](params.rank,params.text)},widgetStateChanged:function(newState){var isShown=newState!==DisplayForm.onlineEntrance&&newState!==DisplayForm.none;if(isShown!==api.isWidgetCurrentlyShown){var type=isShown?WINDOW.proonto.Events.onShow:WINDOW.proonto.Events.onHide;if(!publicHandlers[type])return;for(var handlers=publicHandlers[type],i=0,len=handlers.length;len>i;i++)handlers[i]()}api.isWidgetCurrentlyShown=isShown}};return api}(WINDOW),isWidgetFocused=!1,isCustomButton=!1,initialCustomButtonResize=!1,welcomeWidth=null,isHostingSiteFocused=!0,isTabFocused=!0,titleAnimationTimeout=null,isTitleAnimationTimeoutOn=!1,origTitle=document.title,idleTimer=null,minToIdleMode=18e5,currentScroll=null,bodyStyles={position:null,overflowY:null,webkitTextSizeAdjust:null},bodyStyleIsActive=!1,updateWidgetPositionMobile=!0,naturalScroll=!0,initStylesForIFrame=function(){var pacmanAnimationResizeWidth=5,pacmanAnimationResizeHeight=10;STATES_STYLES=[],STATES_STYLES[DisplayForm.none]={width:"0px",height:"0px",background:"transparent"},STATES_STYLES[DisplayForm.onlineEntrance]={height:"75px",deviceStyles:{desktop:{width:"218px",minWidth:"auto"},tablet:{width:"145px",minWidth:"auto"},smartphone:{width:"145px",height:"75px",minWidth:"auto",right:"10px",bottom:"15px",top:"auto",background:"transparent"}}},STATES_STYLES[DisplayForm.contactDetails]={minWidth:"auto",deviceStyles:{desktop:{height:310+pacmanAnimationResizeHeight+"px",width:311+pacmanAnimationResizeWidth+"px"},tablet:{height:310+pacmanAnimationResizeHeight+"px",width:311+pacmanAnimationResizeWidth+"px"},smartphone:{width:viewportWidthInPixels()+"px",height:viewportHeightInPixels()+"px",right:"0px",bottom:"auto",top:"0px",background:"white"}}},STATES_STYLES[DisplayForm.onlineChat]={deviceStyles:{desktop:{width:"311px",height:"270px",minWidth:"auto"},tablet:{width:"311px",height:"270px",minWidth:"auto"},smartphone:{width:"100%",height:"100%",right:"0px",top:"0px",background:"white"}}},STATES_STYLES[DisplayForm.chatLeadForm]={height:310+pacmanAnimationResizeHeight+"px",width:311+pacmanAnimationResizeWidth+"px",minWidth:"auto"},STATES_STYLES[DisplayForm.chatInvitation]={bottom:"10px",height:"150px",right:"10px",width:"400px",minWidth:"auto"}},resetTimer=function(){null!==idleTimer&&clearTimeout(idleTimer),idleTimer=setTimeout(function(){idleTimer=null,MESSAGE.send(MESSAGE.toHost.sendIdleMode,!0,function(){})},minToIdleMode)};window.addEventListener?window.addEventListener("mousemove",resetTimer,!1):window.attachEvent&&window.attachEvent("mousemove",resetTimer),window.addEventListener?window.addEventListener("keydown",resetTimer,!1):window.attachEvent&&window.attachEvent("keydown",resetTimer),window.addEventListener?(window.addEventListener("focus",function(){isHostingSiteFocused=!0,setTabFocusState()},!0),window.addEventListener("blur",function(){isHostingSiteFocused=!1,setTabFocusState()},!0)):window.attachEvent&&(window.attachEvent("focus",function(){isHostingSiteFocused=!0,setTabFocusState()},!0),window.attachEvent("blur",function(){isHostingSiteFocused=!1,setTabFocusState()},!0));var onAgentApproach=function(agent){AGENT=agent},setWidgetFocusState=function(widgetFocusState){isWidgetFocused=widgetFocusState,setTabFocusState()},setTabFocusState=function(){isTabFocused=isWidgetFocused||isHostingSiteFocused,isTitleAnimationTimeoutOn&&isTabFocused&&cancelTitleAnimation()},cancelTitleAnimation=function(){clearTimeout(titleAnimationTimeout),isTitleAnimationTimeoutOn=!1,document.title=origTitle},calcTitleAnimation=function(){function doTitleAnimation(){document.title=document.title===origTitle?newTitle:origTitle,titleAnimationTimeout=setTimeout(doTitleAnimation,1200),isTitleAnimationTimeoutOn=!0}var newTitle="You have a new message";isTitleAnimationTimeoutOn||isTabFocused||(origTitle=document.title,doTitleAnimation(),playSound())},INIT_MAIN=function(companyId){MESSAGE.on(MESSAGE.toWidget.widgetLoad,widgetLoaded),MESSAGE.on(MESSAGE.toWidget.customButton,customButton),MESSAGE.on(MESSAGE.toWidget.contactDetailsEntered,WIDGET.contactDetailsEnteredApi),MESSAGE.on(MESSAGE.toWidget.onChatMessage,WIDGET.chatMessageApi),MESSAGE.on(MESSAGE.toWidget.onClientAction.name,WIDGET.clientActionApi),MESSAGE.on(MESSAGE.toWidget.messageClick,messageClick),MESSAGE.on(MESSAGE.toWidget.newState,updateWidgetState),MESSAGE.on(MESSAGE.toWidget.blockClient,blockClient),MESSAGE.on(MESSAGE.toWidget.resize,doResize),MESSAGE.on(MESSAGE.toWidget.sendFocus,pausePositioning),MESSAGE.on(MESSAGE.toWidget.sendBlur,resumePositioning),MESSAGE.on(MESSAGE.toWidget.onClientFeedback,WIDGET.onClientFeedback),MESSAGE.on(MESSAGE.toWidget.onAgentApproach,onAgentApproach),MESSAGE.on(MESSAGE.toWidget.setWidgetFocusState,setWidgetFocusState),MESSAGE.on(MESSAGE.toWidget.calcTitleAnimation,calcTitleAnimation),MESSAGE.on(MESSAGE.toWidget.calcTitleAnimation,calcTitleAnimation),initStylesForIFrame()},scrollBack=function(){null!==currentScroll&&(window.scrollTo(0,currentScroll),naturalScroll=!0,updateWidgetPositionMobile=!1,clearInterval(pollMobilePosition))},viewportHeightInPixels=function(){return window.innerHeight},viewportWidthInPixels=function(){return window.innerWidth},pausePositioning=function(){setTimeout(function(){MESSAGE.send(MESSAGE.toHost.parentParams,{height:window.innerHeight,width:window.innerWidth},function(){})},300),updateWidgetPositionMobile=!1},resumePositioning=function(){setTimeout(function(){MESSAGE.send(MESSAGE.toHost.parentParams,{height:window.innerHeight,width:window.innerWidth},function(){})},300),updateWidgetPositionMobile=!0},findWidget=function(){naturalScroll&&(currentScroll=window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,naturalScroll=!1);var widget=document.getElementById("proonto-widget"),widgetPos=widget.scrollTop;updateWidgetPositionMobile&&window.scrollTo(0,widgetPos)},widgetLoaded=function(initDetails){CLIENT_ID=initDetails.clientId,UNIQUE_ID=initDetails.uniqueId,COMPANY_ID=initDetails.companyId,IS_IN_CONTROL_GROUP=!!initDetails.controlGroup,CLIENT_NAME=initDetails.clientName,IS_AGENT_ONLINE=initDetails.isAgentOnline,setProontoData("prt_clientId",CLIENT_ID,1),setProontoData("prt_companyId",COMPANY_ID,87600),setProontoData("prt_uniqueId",UNIQUE_ID,87600),setProontoData("prt_clientName",CLIENT_NAME,1440),"function"==typeof window.onProontoChatLoad&&window.onProontoChatLoad(initDetails.isAgentOnline,IS_IN_CONTROL_GROUP)},customButton=function(width){if(welcomeWidth=width,isCustomButton=!0,initialCustomButtonResize){var buttonWidth=width;38>buttonWidth&&(buttonWidth=38),WIDGET_CONTAINER.style.width=buttonWidth+"px",WIDGET_CONTAINER.style.minWidth=buttonWidth+"px"}},doResize=function(newHeight){var deviceType=calcDeviceType();"smartphone"===deviceType&&(newHeight=.92*viewportHeightInPixels+"%"),WIDGET_CONTAINER.style.height=newHeight+"px"},setDeviceStyles=function(stylesArray){for(var key in stylesArray)stylesArray.hasOwnProperty(key)&&(WIDGET_CONTAINER.style[key]=stylesArray[key])},blockClient=function(){setProontoData("prt_status","nevela",87600)},updateWidgetState=function(newState){MESSAGE.send(MESSAGE.toHost.parentParams,{height:window.innerHeight,width:window.innerWidth},function(){});var deviceType=calcDeviceType();if("smartphone"===deviceType){var properties=["height","width","overflow","position"],openValues=["100%","100%","hidden","fixed"];if(initStylesForIFrame(),"ONLINE_CHAT"===newState||"CONTACT_DETAILS"===newState){if(!bodyStyleIsActive){for(var i=0;i<properties.length;i++)bodyStyles[properties[i]]=document.body.style[properties[i]],document.body.style[properties[i]]=openValues[i];bodyStyleIsActive=!0,updateWidgetPositionMobile=!0,findWidget()}}else{scrollBack();for(var j=0;j<properties.length;j++)document.body.style[properties[j]]=bodyStyles[properties[j]];bodyStyleIsActive=!1}}deviceType=calcDeviceType();for(var key in STATES_STYLES[newState])STATES_STYLES[newState].hasOwnProperty(key)&&(WIDGET_CONTAINER.style[key]=STATES_STYLES[newState][key]);if(STATES_STYLES[newState].deviceStyles){var perDeviceStyle=STATES_STYLES[newState].deviceStyles[deviceType];setDeviceStyles(perDeviceStyle)}if(isCustomButton&&"ONLINE_ENTRANCE"===newState){var buttonWidth=17*welcomeWidth+60;38>buttonWidth&&(buttonWidth=38),WIDGET_CONTAINER.style.width=buttonWidth+"px",WIDGET_CONTAINER.style.minWidth=buttonWidth+"px",initialCustomButtonResize=!0}WIDGET.widgetStateChanged(newState)},messageClick=function(){},playSound=function(){MESSAGE.send(MESSAGE.toHost.playSound,"",function(){})},getCompanyId=function(){var me=document.querySelector("script[data-company-id]"),companyId=null===me?null:me.getAttribute("data-company-id");if(null===companyId&&"undefined"!=typeof _STM&&(companyId="undefined"!=typeof _STM[0]?_STM[0][1]:undefined),null===companyId){var widgetHostNoProtocol=WIDGET_HOST.replace("https:","").replace("http:","");me=document.querySelector('script[src*="'+widgetHostNoProtocol+'"]');var vars={};me.src.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value});vars.companyId&&(companyId=vars.companyId)}return companyId},getNoTracking=function(){var me=document.querySelector("script[no-tracking]");return null===me?!1:me.getAttribute("no-tracking")},getWhiteLabelWidget=function(){var me=document.querySelector("script[white-label-widget]");return null===me?!1:me.getAttribute("white-label-widget")},getIsDemo=function(){var me=document.querySelector("script[proonto-is-demo]");return null===me?!1:me.getAttribute("proonto-is-demo")},getEnv=function(){var me=document.querySelector("script[proonto-env]");return null===me?"prod":me.getAttribute("proonto-env")},getUrl=function(){var url=encodeURIComponent(location.href),me=document.querySelector("script[proonto-url]");return null===me?url:me.getAttribute("proonto-url")},getViewport=function(){var e=window,a="inner";return"innerWidth"in window||(a="client",e=document.documentElement||document.body),{width:e[a+"Width"],height:e[a+"Height"]}},DEVICE_DEFINITIONS={},MIN_WIDTH="minWidth",desktopDefinition=DEVICE_DEFINITIONS[DEVICE_TYPES.DESKTOP]={};desktopDefinition[MIN_WIDTH]=1024;var tabletDefinition=DEVICE_DEFINITIONS[DEVICE_TYPES.TABLET]={};tabletDefinition[MIN_WIDTH]=600;var calcDeviceType=function(){var viewPortWidth=getViewport().width;return viewPortWidth<DEVICE_DEFINITIONS[DEVICE_TYPES.TABLET][MIN_WIDTH]?DEVICE_TYPES.SMARTPHONE:viewPortWidth<DEVICE_DEFINITIONS[DEVICE_TYPES.DESKTOP][MIN_WIDTH]?DEVICE_TYPES.TABLET:DEVICE_TYPES.DESKTOP},resetOtherCompanyId=function(companyId){var oldPrtCompanyId=getProontoCookie("prt_companyId"),oldPrtCompanyIdStr=oldPrtCompanyId?oldPrtCompanyId.toString():"",newCompanyStr=companyId.toString();oldPrtCompanyIdStr&&oldPrtCompanyIdStr.length>0&&oldPrtCompanyIdStr!==newCompanyStr&&(setProontoCookie("prt_companyId","",0),setProontoCookie("prt_clientId","",0),setProontoCookie("prt_clientName","",0))},fn=function(){var newNode=document.createElement("div"),companyId=getCompanyId(),noTracking=getNoTracking(),whiteLabelWidget=getWhiteLabelWidget();resetOtherCompanyId(companyId);var isDemo=getIsDemo(),screenType=calcDeviceType(),url=(getEnv(),getUrl()),cookiesEnabled=!(!navigator||!navigator.cookieEnabled),status=getProontoData("prt_status");"nevela"!==status&&(newNode.innerHTML='<div id="proonto-widget" style="margin: 0px; padding: 0px; border: 0px; min-width:auto; overflow: hidden; position: fixed; z-index: 9999999991; right: 15px; bottom: 10px; display: block; width: 0px; height: 0px; background: transparent;"><iframe name="proonto_widget" scrolling="no" frameborder="0" src="'+WIDGET_HOST+"/code/app/index.html?c="+companyId+"&u="+url+"&r="+encodeURIComponent(document.referrer)+"&t="+encodeURIComponent(document.title)+"&d="+isDemo+"&noTracking="+noTracking+"&whiteLabelWidget="+whiteLabelWidget+"&screenType="+screenType+"&clientId="+getProontoData("prt_clientId")+"&cookiesEnabled="+cookiesEnabled+"&uniqueId="+getProontoData("prt_uniqueId")+"&clientName="+encodeURIComponent(getProontoData("prt_clientName"))+'" style="vertical-align: bottom; position: relative; width: 100%; height: 100%; margin: 0px; overflow: hidden; background-color: transparent;"></iframe></div>',document.body.appendChild(newNode),WIDGET_WINDOW=newNode.querySelector("iframe").contentWindow,WIDGET_CONTAINER=newNode.querySelector("#proonto-widget"),MESSAGE=new MessageFactory(ORIGIN_REGEX,WIDGET_WINDOW),INIT_MAIN(companyId))},done=!1,top=!0,win=WINDOW,doc=WINDOW.document,root=doc.documentElement,modern=doc.addEventListener,add=modern?"addEventListener":"attachEvent",rem=modern?"removeEventListener":"detachEvent",pre=modern?"":"on",init=function(e){"readystatechange"===e.type&&"complete"!==doc.readyState||(("load"===e.type?win:doc)[rem](pre+e.type,init,!1),!done&&(done=!0)&&fn.call(win,e.type||e))},poll=function(){try{root.doScroll("left")}catch(e){return void setTimeout(poll,50)}init("poll")};if("complete"===doc.readyState)fn.call(win,"lazy");else{if(!modern&&root.doScroll){try{top=!win.frameElement}catch(e){}top&&poll()}doc[add](pre+"DOMContentLoaded",init,!1),doc[add](pre+"readystatechange",init,!1),win[add](pre+"load",init,!1)}}catch(e){reportError(e)}}(window);